# -*- ruby -*-

Autotest.add_hook :initialize do |at|
  at.extra_files << "../../ParseTree/dev/test/pt_testcase.rb"
  at.libs << ":../../ParseTree/dev/lib:../../ParseTree/dev/test"
  at.exceptions << 'unit'

  at.unit_diff = "unit_diff -u -b"

  at.add_mapping(/^lib\/.*\.y$/) do |f, _|
    at.files_matching %r%^test/.*#{File.basename(f, '.y').gsub '_', '_?'}.rb$%
  end

  at.add_mapping(/pt_testcase.rb/) do |f, _|
    at.files_matching(/^test.*rb$/)
  end
end

Autotest.add_hook :run_command do |at|
  system "rake parser"
end
